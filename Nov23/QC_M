cd /data2/hanna/synaptogenesis/newvolume
singularity shell --bind /data2:/mnt qc_cell.sif
cd /mnt/hanna/synaptogenesis/newvolume/analysis/Nov2023/QC_M

#go into R 
library(scuttle)
library(scran)
library(irlba)
library(Rtsne)
library(Matrix)
library(ggplot2)
library(biomaRt)
library(viridisLite)
library(viridis)
library(scDblFinder)

#These count matricies have been filtered for ngenes > 400, lib.sizes > 500, and ngenes/lib.sizes < 0.9. Code in Nov2023/separating species. 
#This initial QC was done to decrease the size of the data, according to the treshold we set with Ivan. 
counts <- readMM('/mnt/hanna/synaptogenesis/newvolume/analysis/Nov2023/counts_M.mtx')
colnames <- read.csv('/mnt/hanna/synaptogenesis/newvolume/analysis/Nov2023/colnames_M.csv')
colnames(counts) <- colnames[,2]
rownames <- read.csv('/mnt/hanna/synaptogenesis/newvolume/analysis/Nov2023/rownames_M.csv')
rownames(counts) <- rownames[,2]
metadata <- read.csv('/mnt/hanna/synaptogenesis/newvolume/analysis/Nov2023/metadata_M.csv')

path2data   <- '/mnt/ivanir/Feline2023/ParseBS/newvolume/analysis/sCell/combined/all-well/DGE_unfiltered'
genes     <- read.csv(paste0(path2data, "/all_genes.csv"))
lib.sizes <- colSums(counts)

#sample_info <- read.table('/mnt/ivanir/Feline2023/ParseBS/newvolume/analysis/sample_info.tab', sep = "\t", header = TRUE)



